/*
==========================================================================================
  Dependencies
==========================================================================================
*/

import c from "../global/constants.ts";
import { throttle } from "lodash";
import Helpers from "../global/helpers.ts";
import Actuator from "../module/actuator.ts";

/*
==========================================================================================
  Constants
==========================================================================================
*/

const ANIMATION_DURATION = parseInt(
  getComputedStyle(document.documentElement)
    .getPropertyValue("--animation-duration-base").replace("ms", ""),
);

/*
==========================================================================================
  Selectors
==========================================================================================
*/

/*
==========================================================================================
  Public Functions
==========================================================================================
*/

const Input = {
  initialize() {
    bindInputs();
  },
};

/*
==========================================================================================
  Private Functions
==========================================================================================
*/

const bindInputs = () => {
  const keys = [c.key.up, c.key.down, c.key.left, c.key.right];
  const handler = (direction) => Actuator.move(direction);

  Helpers.bindKeys(
    keys,
    throttle(handler, ANIMATION_DURATION, { trailing: false }),
  );
};

/*
==========================================================================================
  Exports
==========================================================================================
*/

export default Input;
