/*
==========================================================================================
  Dependencies
==========================================================================================
*/

import b from "../global/browser.ts";
import c from "../global/constants.ts";
import { throttle } from "lodash";
import Helpers from "../global/helpers.ts";
import Actuator from "../module/actuator.ts";

/*
==========================================================================================
  Constants
==========================================================================================
*/

/*
==========================================================================================
  Selectors
==========================================================================================
*/

/*
==========================================================================================
  Public Functions
==========================================================================================
*/

const Input = {
  initialize() {
    bindInputs();
  },
};

/*
==========================================================================================
  Private Functions
==========================================================================================
*/

const bindInputs = () => {
  const keys = [c.key.up, c.key.down, c.key.left, c.key.right];
  const handler = (direction) => Actuator.move(direction);

  Helpers.bindKeys(keys, throttle(handler, 100, { trailing: false }));
};

const postInput = (input) => {
  const config = { method: b.request.post, body: input };

  fetch("/move", config).then((response) => Actuator.move(response));
};

/*
==========================================================================================
  Exports
==========================================================================================
*/

export default Input;
